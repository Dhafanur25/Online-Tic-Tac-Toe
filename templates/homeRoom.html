<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
            background-color: #010b59;
        }

        h1{
            margin: 10px;
            color: #ffffff;

        }
        pre {
            margin: 3px;
            color: #ffffff;
        }
        button {
            margin: 10px;
            padding: 10px;
            cursor: pointer;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.4/socket.io.js"></script>
    <title>Home Room</title>
</head>
<body>
    <h1>Welcome to Tic-Tac-Toe Online</h1>
    <pre>Dhafa Nur Fadhilah     - 1301213263</pre>
    <pre>Fannisa Eimin Aurora   - 1301213150</pre>
    <pre>Firman Hoerulloh       - 1301213392</pre>
    <pre>Reza Mu'ammar Widyanto - 1301210513</pre>
    <pre> </pre>
    <button onclick="joinRoom()">Join Game Room</button>

    <script>
        var socket = io.connect('http://' + '192.168.18.202'+ ':' + location.port);

        console.log("Socket", socket);

        function fetchRoomId(callback) {
            fetch('/fetchRoomId')
                .then(response => response.json())
                .then(data => {
                    callback(data.room_id);
                })
        }

        function joinRoom() {
            fetchRoomId(function(room_id) {
                console.log('Joining room:', room_id);
                socket.emit('join_room', { room_id: room_id});
            });
        }

        socket.on('room_joined', function (data) {
            window.location.href = '/gameRoom/' + data.room_id + '?' + encodeURIComponent(data.player_symbol);  
        });
    </script>
</body>
</html>

